!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="./",n(n.s=1)}([,function(t,e){navigator.userAgent.toLowerCase().indexOf("dingtalk")>-1&&document.writeln('<script src="https://appx/web-view.min.js"><\/script>');var n,o,a=17,l={};dd.postMessage({}),dd.onMessage=function(t){n={lon:t.lon,lat:t.lat}||{lon:120.14989,lat:30.27751},o=t.cityName||"杭州市",$.ajax({url:encodeURI("https://dh.ditu.zj.cn:9443/inverse/getInverseGeocoding.jsonp?&detail=1&zoom=11&latlon="+n.lon+","+n.lat+"&lat=&lon=&customer=2"),dataType:"jsonp",success:function(t){l.latitude=parseFloat(t.latlon.split(",")[1]),l.longitude=parseFloat(t.latlon.split(",")[0]),l.location=t.city.value+t.dist.value+t.town.value+t.poi},error:function(t){dd.alert({content:"地址解析出错"})}}),function(){var t=L.map("map",{crs:L.CRS.CustomEPSG4326,center:n,minZoom:5,zoom:a,inertiaDeceleration:15e3,zoomControl:!1}),e=new L.GXYZ("https://ditu.zjzwfw.gov.cn/mapserver/vmap/zjvmap/getMAP?x={x}&y={y}&l={z}&styleId=tdt_biaozhunyangshi_2017",{tileSize:512,minZoom:5});t.addLayer(e);var i=new L.GXYZ("https://ditu.zjzwfw.gov.cn/mapserver/label/zjvmap/getImg?x={x}&y={y}&l={z}&styleId=tdt_biaozhunyangshi_2017",{tileSize:512,hitDetection:!0,keepBuffer:0,updateWhenZooming:!1});t.addLayer(i);var r=L.icon({iconUrl:"../img/indoor_pub_poi_pressed.png",iconSize:[21,30],iconAnchor:[10,20]}),d=L.marker([t.getCenter().lat,t.getCenter().lng],{draggable:!1,opacity:1,icon:r});t.addLayer(d);var s=L.circle([t.getCenter().lat,t.getCenter().lng],{radius:30});t.addLayer(s),dd.postMessage({render:!0}),t.on("click",function(t){var e=encodeURI("https://dh.ditu.zj.cn:9443/inverse/getInverseGeocoding.jsonp?&detail=1&zoom=11&latlon="+t.latlng.lng+","+t.latlng.lat+"&lat=&lon=&customer=2");$.ajax({url:e,dataType:"jsonp",success:function(e){l.latitude=parseFloat(e.latlon.split(",")[1]),l.longitude=parseFloat(e.latlon.split(",")[0]),l.location=e.city.value+e.dist.value+e.town.value+e.poi,d.setLatLng(t.latlng),d.unbindTooltip().bindTooltip(e.city.value+e.dist.value+e.town.value+e.poi,{offset:[0,10],direction:"bottom"}).openTooltip()},error:function(t){dd.alert({content:"地址解析出错"})}})}),$(".iptSearch").on("keydown",function(e){if(13==e.keyCode)if(e.target.value){var n=o+e.target.value,a=encodeURI("https://dh.ditu.zj.cn:9446/geocoding/getLatLonByAddress.jsonp?&city="+o+"&keyword="+n+"&width=500&height=430&pn=1&customer=2&encode=UTF-8");$.ajax({url:a,dataType:"jsonp",success:function(n){if("0.0,0.0"==n.strlatlon)dd.alert({content:"未查询到相关信息"});else{l.latitude=parseFloat(n.strlatlon.split(",")[1]),l.longitude=parseFloat(n.strlatlon.split(",")[0]),l.location=n.city+e.target.value;var o={lon:l.longitude,lat:l.latitude};d.setLatLng(o),d.unbindTooltip().bindTooltip(e.target.value,{offset:[0,10],direction:"bottom"}).openTooltip(),t.panTo(o)}},error:function(t){dd.alert({content:"地址解析出错"})}})}else dd.alert({content:"请输入查询关键字"})}),$(".resetBtn").on("click",function(e){t.setView([Number(n.lat),Number(n.lon)],a),d.unbindTooltip().setLatLng(n)}),$(".modifyBtn").on("click",function(){dd.postMessage(l)})}()}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvbGFiZWwuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJkb2N1bWVudCIsIndyaXRlbG4iLCJpbml0TGF0bG5nIiwiY2l0eU5hbWUiLCJpbml0Wm9vbSIsIm5ld0NlbnRlckRhdGEiLCJkZCIsInBvc3RNZXNzYWdlIiwib25NZXNzYWdlIiwiZSIsImxvbiIsImxhdCIsIiQiLCJhamF4IiwidXJsIiwiZW5jb2RlVVJJIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwicmVzIiwibGF0aXR1ZGUiLCJwYXJzZUZsb2F0IiwibGF0bG9uIiwic3BsaXQiLCJsb25naXR1ZGUiLCJsb2NhdGlvbiIsImNpdHkiLCJkaXN0IiwidG93biIsInBvaSIsImVycm9yIiwiZXJyIiwiYWxlcnQiLCJjb250ZW50IiwibWFwIiwiTCIsImNycyIsIkNSUyIsIkN1c3RvbUVQU0c0MzI2IiwiY2VudGVyIiwibWluWm9vbSIsInpvb20iLCJpbmVydGlhRGVjZWxlcmF0aW9uIiwiem9vbUNvbnRyb2wiLCJsYXllciIsIkdYWVoiLCJ0aWxlU2l6ZSIsImFkZExheWVyIiwibGFiZWxMYXllciIsImhpdERldGVjdGlvbiIsImtlZXBCdWZmZXIiLCJ1cGRhdGVXaGVuWm9vbWluZyIsImN1c3RvbUljb24iLCJpY29uIiwiaWNvblVybCIsImljb25TaXplIiwiaWNvbkFuY2hvciIsIm1hcmtlciIsImdldENlbnRlciIsImxuZyIsImRyYWdnYWJsZSIsIm9wYWNpdHkiLCJjaXJjbGUiLCJyYWRpdXMiLCJyZW5kZXIiLCJvbiIsInJldmVyc2VSZXNvbHV0aW9uVXJsIiwibGF0bG5nIiwic2V0TGF0TG5nIiwidW5iaW5kVG9vbHRpcCIsImJpbmRUb29sdGlwIiwib2Zmc2V0IiwiZGlyZWN0aW9uIiwib3BlblRvb2x0aXAiLCJrZXlDb2RlIiwidGFyZ2V0Iiwia2V5V29yZCIsInJlc29sdXRpb25VcmwiLCJzdHJsYXRsb24iLCJuZXdDZW50ZXJMYXRsb24iLCJwYW5UbyIsInNldFZpZXciLCJOdW1iZXIiLCJpbml0Il0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLGFBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJC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RUFBQVksZ0JBQUFDLFlBQUE1RCxFQUFBaUUsT0FBQTdGLE9BQWtGeUYsUUFBQSxNQUFBQyxVQUFBLFdBQXNDQyxjQUN4SHZDLEVBQUE4QyxNQUFBRCxLQUdBakQsTUFBQSxTQUFBQyxHQUNBeEIsR0FBQXlCLE9BQ0FDLFFBQUEsbUJBS0ExQixHQUFBeUIsT0FDQUMsUUFBQSxlQU1BcEIsRUFBQSxhQUFBb0QsR0FBQSxpQkFBQXZELEdBQ0F3QixFQUFBK0MsU0FBQUMsT0FBQS9FLEVBQUFTLEtBQUFzRSxPQUFBL0UsRUFBQVEsTUFBQU4sR0FDQW9ELEVBQUFZLGdCQUFBRCxVQUFBakUsS0FFQVUsRUFBQSxjQUFBb0QsR0FBQSxtQkFDQTFELEdBQUFDLFlBQUFGLEtBdEdBNkUiLCJmaWxlIjoianMvbGFiZWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi4vXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbiIsImlmIChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5kZXhPZignZGluZ3RhbGsnKSA+IC0xKSB7XHJcbiAgICBkb2N1bWVudC53cml0ZWxuKCc8c2NyaXB0IHNyYz1cImh0dHBzOi8vYXBweC93ZWItdmlldy5taW4uanNcIicgKyAnPicgKyAnPCcgKyAnLycgKyAnc2NyaXB0PicpO1xyXG4gIH1cclxuICB2YXIgaW5pdExhdGxuZywgaW5pdFpvb20gPSAxNywgY2l0eU5hbWUsIG5ld0NlbnRlckRhdGEgPSB7fTtcclxuICBcclxuICBkZC5wb3N0TWVzc2FnZSh7fSk7XHJcbiAgZGQub25NZXNzYWdlID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICBpbml0TGF0bG5nID0ge2xvbjogZS5sb24sIGxhdDogZS5sYXR9IHx8IHtsb246IDEyMC4xNDk4OSwgbGF0OiAzMC4yNzc1MX07ICAvLyDpu5jorqTnu4/nuqzluqbkuLrok53lpKnllYbliqHkuK3lv4NcclxuICAgICAgY2l0eU5hbWUgPSBlLmNpdHlOYW1lIHx8IFwi5p2t5bee5biCXCI7XHJcbiAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICB1cmw6IGVuY29kZVVSSShcImh0dHBzOi8vZGguZGl0dS56ai5jbjo5NDQzL2ludmVyc2UvZ2V0SW52ZXJzZUdlb2NvZGluZy5qc29ucD8mZGV0YWlsPTEmem9vbT0xMSZsYXRsb249XCIgKyBpbml0TGF0bG5nLmxvbiArIFwiLFwiICsgaW5pdExhdGxuZy5sYXQgKyBcIiZsYXQ9Jmxvbj0mY3VzdG9tZXI9MlwiKSxcclxuICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25wXCIsXHJcbiAgICAgICAgICAvLyBqc29ucDogXCJjYWxsYmFja1wiLFxyXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sYXRpdHVkZSA9IHBhcnNlRmxvYXQocmVzLmxhdGxvbi5zcGxpdCgnLCcpWzFdKVxyXG4gICAgICAgICAgICAgIG5ld0NlbnRlckRhdGEubG9uZ2l0dWRlID0gcGFyc2VGbG9hdChyZXMubGF0bG9uLnNwbGl0KCcsJylbMF0pXHJcbiAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sb2NhdGlvbiA9IHJlcy5jaXR5LnZhbHVlICsgcmVzLmRpc3QudmFsdWUgKyByZXMudG93bi52YWx1ZSArIHJlcy5wb2k7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICBkZC5hbGVydCh7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwi5Zyw5Z2A6Kej5p6Q5Ye66ZSZXCJcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAvLyAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGluaXQoKVxyXG4gICAgLy8gICB9LCAzMDAwKTtcclxuICB9XHJcbiAgZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgICAgdmFyIG1hcCA9IEwubWFwKCdtYXAnLHtjcnM6TC5DUlMuQ3VzdG9tRVBTRzQzMjYsY2VudGVyOiBpbml0TGF0bG5nLCBtaW5ab29tOiA1LCB6b29tOiBpbml0Wm9vbSwgaW5lcnRpYURlY2VsZXJhdGlvbjoxNTAwMCwgem9vbUNvbnRyb2w6IGZhbHNlfSk7XHJcbiAgICAgIHZhciB0aWxlQWRkcmVzcyA9ICdodHRwczovL2RpdHUuemp6d2Z3Lmdvdi5jbi9tYXBzZXJ2ZXIvdm1hcC96anZtYXAvZ2V0TUFQP3g9e3h9Jnk9e3l9Jmw9e3p9JnN0eWxlSWQ9dGR0X2JpYW96aHVueWFuZ3NoaV8yMDE3JztcclxuXHJcbiAgICAgIHZhciBsYXllciA9IG5ldyBMLkdYWVoodGlsZUFkZHJlc3MsIHt0aWxlU2l6ZTo1MTIsIG1pblpvb206IDV9KTtcclxuICAgICAgbWFwLmFkZExheWVyKGxheWVyKTtcclxuXHJcbiAgICAgIC8vIOa3u+WKoOazqOiusOWbvuWxglxyXG4gICAgLy8gICB2YXIgbGFiZWxMYXllciA9IG5ldyBMLkdXVlRBbm5vKHt0aWxlU2l6ZTo1MTJ9KTtcclxuICAgIC8vICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgQ3VzdG9tLlVSTERhdGFTb3VyY2UoKTtcclxuICAgIC8vICAgZGF0YVNvdXJjZS51cmwgPSAnaHR0cHM6Ly9kaXR1Lnpqendmdy5nb3YuY24vbWFwc2VydmVyL2xhYmVsL3pqdm1hcC9nZXREYXRhcz94PSR7eH0meT0ke3l9Jmw9JHt6fSZzdHlsZUlkPXRkdF9iaWFvemh1bnlhbmdzaGlfMjAxNyc7XHJcbiAgICAvLyAgIGxhYmVsTGF5ZXIuYWRkRGF0YVNvdXJjZShkYXRhU291cmNlKTtcclxuICAgIC8vICAgbWFwLmFkZExheWVyKGxhYmVsTGF5ZXIpO1xyXG4gICAgICB2YXIgbGFiZWxMYXllciA9IG5ldyBMLkdYWVooJ2h0dHBzOi8vZGl0dS56anp3ZncuZ292LmNuL21hcHNlcnZlci9sYWJlbC96anZtYXAvZ2V0SW1nP3g9e3h9Jnk9e3l9Jmw9e3p9JnN0eWxlSWQ9dGR0X2JpYW96aHVueWFuZ3NoaV8yMDE3Jyx7dGlsZVNpemU6NTEyLGhpdERldGVjdGlvbjp0cnVlLGtlZXBCdWZmZXI6MCx1cGRhdGVXaGVuWm9vbWluZzpmYWxzZX0pO1xyXG4gICAgICBtYXAuYWRkTGF5ZXIobGFiZWxMYXllcik7XHJcbiAgICAgIHZhciBjdXN0b21JY29uID0gTC5pY29uKHsgXHJcbiAgICAgICAgICBpY29uVXJsOiAnLi4vaW1nL2luZG9vcl9wdWJfcG9pX3ByZXNzZWQucG5nJyxcclxuICAgICAgICAgIGljb25TaXplOiBbMjEsIDMwXSxcclxuICAgICAgICAgIGljb25BbmNob3I6ICAgWzEwLCAyMF0sXHJcbiAgICAgIH0pOyBcclxuICAgICAgdmFyIG1hcmtlciA9IEwubWFya2VyKCBcclxuICAgICAgICAgIFttYXAuZ2V0Q2VudGVyKCkubGF0LCBtYXAuZ2V0Q2VudGVyKCkubG5nXSwgXHJcbiAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgIGRyYWdnYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgb3BhY2l0eTogMSxcclxuICAgICAgICAgICAgICBpY29uOiBjdXN0b21JY29uXHJcbiAgICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIG1hcC5hZGRMYXllcihtYXJrZXIpO1xyXG4gICAgICB2YXIgY2lyY2xlID0gTC5jaXJjbGUoW21hcC5nZXRDZW50ZXIoKS5sYXQsIG1hcC5nZXRDZW50ZXIoKS5sbmddLCB7cmFkaXVzOiAzMH0pO1xyXG4gICAgICBtYXAuYWRkTGF5ZXIoY2lyY2xlKTtcclxuXHJcbiAgICAgIGRkLnBvc3RNZXNzYWdlKHtyZW5kZXI6IHRydWV9KTsgLy8g57uT5p2fbG9hZGluZ1xyXG5cclxuICAgICAgbWFwLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIHZhciByZXZlcnNlUmVzb2x1dGlvblVybCA9IGVuY29kZVVSSShcImh0dHBzOi8vZGguZGl0dS56ai5jbjo5NDQzL2ludmVyc2UvZ2V0SW52ZXJzZUdlb2NvZGluZy5qc29ucD8mZGV0YWlsPTEmem9vbT0xMSZsYXRsb249XCIgKyBlLmxhdGxuZy5sbmcgKyBcIixcIiArIGUubGF0bG5nLmxhdCArIFwiJmxhdD0mbG9uPSZjdXN0b21lcj0yXCIpO1xyXG4gICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICB1cmw6IHJldmVyc2VSZXNvbHV0aW9uVXJsLFxyXG4gICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25wXCIsXHJcbiAgICAgICAgICAgICAgLy8ganNvbnA6IFwiY2FsbGJhY2tcIixcclxuICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sYXRpdHVkZSA9IHBhcnNlRmxvYXQocmVzLmxhdGxvbi5zcGxpdCgnLCcpWzFdKVxyXG4gICAgICAgICAgICAgICAgICBuZXdDZW50ZXJEYXRhLmxvbmdpdHVkZSA9IHBhcnNlRmxvYXQocmVzLmxhdGxvbi5zcGxpdCgnLCcpWzBdKVxyXG4gICAgICAgICAgICAgICAgICBuZXdDZW50ZXJEYXRhLmxvY2F0aW9uID0gcmVzLmNpdHkudmFsdWUgKyByZXMuZGlzdC52YWx1ZSArIHJlcy50b3duLnZhbHVlICsgcmVzLnBvaTtcclxuICAgICAgICAgICAgICAgICAgbWFya2VyLnNldExhdExuZyhlLmxhdGxuZyk7XHJcbiAgICAgICAgICAgICAgICAgIG1hcmtlci51bmJpbmRUb29sdGlwKCkuYmluZFRvb2x0aXAocmVzLmNpdHkudmFsdWUgKyByZXMuZGlzdC52YWx1ZSArIHJlcy50b3duLnZhbHVlICsgcmVzLnBvaSwge29mZnNldDogWzAsIDEwXSwgZGlyZWN0aW9uIDogXCJib3R0b21cIn0pLm9wZW5Ub29sdGlwKCk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICBkZC5hbGVydCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBcIuWcsOWdgOino+aekOWHuumUmVwiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgICQoJy5pcHRTZWFyY2gnKS5vbigna2V5ZG93bicsZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAvLyBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICBpZihlLmtleUNvZGUgPT0gMTMpe1xyXG4gICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBrZXlXb3JkID0gY2l0eU5hbWUgKyBlLnRhcmdldC52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgdmFyIHJlc29sdXRpb25VcmwgPSBlbmNvZGVVUkkoXCJodHRwczovL2RoLmRpdHUuemouY246OTQ0Ni9nZW9jb2RpbmcvZ2V0TGF0TG9uQnlBZGRyZXNzLmpzb25wPyZjaXR5PVwiICsgY2l0eU5hbWUgKyBcIiZrZXl3b3JkPVwiICsga2V5V29yZCArIFwiJndpZHRoPTUwMCZoZWlnaHQ9NDMwJnBuPTEmY3VzdG9tZXI9MiZlbmNvZGU9VVRGLThcIik7XHJcbiAgICAgICAgICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IHJlc29sdXRpb25VcmwsXHJcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29ucFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgLy8ganNvbnA6IFwiY2FsbGJhY2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3RybGF0bG9uID09IFwiMC4wLDAuMFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRkLmFsZXJ0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwi5pyq5p+l6K+i5Yiw55u45YWz5L+h5oGvXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sYXRpdHVkZSA9IHBhcnNlRmxvYXQocmVzLnN0cmxhdGxvbi5zcGxpdCgnLCcpWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sb25naXR1ZGUgPSBwYXJzZUZsb2F0KHJlcy5zdHJsYXRsb24uc3BsaXQoJywnKVswXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NlbnRlckRhdGEubG9jYXRpb24gPSByZXMuY2l0eSArIGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2VudGVyTGF0bG9uID0ge2xvbjogbmV3Q2VudGVyRGF0YS5sb25naXR1ZGUsIGxhdDogbmV3Q2VudGVyRGF0YS5sYXRpdHVkZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLnNldExhdExuZyhuZXdDZW50ZXJMYXRsb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIudW5iaW5kVG9vbHRpcCgpLmJpbmRUb29sdGlwKGUudGFyZ2V0LnZhbHVlLCB7b2Zmc2V0OiBbMCwgMTBdLCBkaXJlY3Rpb24gOiBcImJvdHRvbVwifSkub3BlblRvb2x0aXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLnBhblRvKG5ld0NlbnRlckxhdGxvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZC5hbGVydCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwi5Zyw5Z2A6Kej5p6Q5Ye66ZSZXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgZGQuYWxlcnQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgY29udGVudDogXCLor7fovpPlhaXmn6Xor6LlhbPplK7lrZdcIlxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICAkKCcucmVzZXRCdG4nKS5vbignY2xpY2snLGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgbWFwLnNldFZpZXcoW051bWJlcihpbml0TGF0bG5nLmxhdCksIE51bWJlcihpbml0TGF0bG5nLmxvbildLCBpbml0Wm9vbSk7XHJcbiAgICAgICAgICBtYXJrZXIudW5iaW5kVG9vbHRpcCgpLnNldExhdExuZyhpbml0TGF0bG5nKTtcclxuICAgICAgfSk7XHJcbiAgICAgICQoXCIubW9kaWZ5QnRuXCIpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIGRkLnBvc3RNZXNzYWdlKG5ld0NlbnRlckRhdGEpO1xyXG4gICAgICB9KVxyXG5cclxuICB9Il0sInNvdXJjZVJvb3QiOiIifQ==