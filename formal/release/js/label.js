!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="./",n(n.s=1)}([,function(t,e){navigator.userAgent.toLowerCase().indexOf("dingtalk")>-1&&document.writeln('<script src="https://appx/web-view.min.js"><\/script>'),dd.getEnv(function(t){t.miniprogram||dd.alert({content:JSON.stringify("运行出错")})});var n,o,a=17,i={};dd.postMessage({}),dd.onMessage=function(t){n={lon:t.lon,lat:t.lat}||{lon:120.14989,lat:30.27751},o=t.cityName||"杭州市",$.ajax({url:encodeURI("http://dh.ditu.zj.cn:18005/inverse/getInverseGeocoding.jsonp?&detail=1&zoom=11&latlon="+n.lon+","+n.lat+"&lat=&lon=&customer=2"),dataType:"jsonp",success:function(t){i.latitude=parseFloat(t.latlon.split(",")[1]),i.longitude=parseFloat(t.latlon.split(",")[0]),i.location=t.city.value+t.dist.value+t.town.value+t.poi},error:function(t){dd.alert({content:"地址解析出错"})}}),function(){var t=L.map("map",{crs:L.CRS.CustomEPSG4326,center:n,minZoom:5,zoom:a,inertiaDeceleration:15e3,zoomControl:!1}),e=new L.GXYZ("http://ditu.zjzwfw.gov.cn/mapserver/vmap/zjvmap/getMAP?x={x}&y={y}&l={z}&styleId=tdt_biaozhunyangshi_2017",{tileSize:512,minZoom:5});t.addLayer(e);var l=new L.GXYZ("http://ditu.zjzwfw.gov.cn/mapserver/label/zjvmap/getImg?x={x}&y={y}&l={z}&styleId=tdt_biaozhunyangshi_2017",{tileSize:512,hitDetection:!0,keepBuffer:0,updateWhenZooming:!1});t.addLayer(l);var r=L.icon({iconUrl:"../img/indoor_pub_poi_pressed.png",iconSize:[21,30],iconAnchor:[10,20]}),d=L.marker([t.getCenter().lat,t.getCenter().lng],{draggable:!1,opacity:1,icon:r}).addTo(t);L.circle([t.getCenter().lat,t.getCenter().lng],{radius:30}).addTo(t),t.on("click",function(t){var e=encodeURI("http://dh.ditu.zj.cn:18005/inverse/getInverseGeocoding.jsonp?&detail=1&zoom=11&latlon="+t.latlng.lng+","+t.latlng.lat+"&lat=&lon=&customer=2");$.ajax({url:e,dataType:"jsonp",success:function(e){i.latitude=parseFloat(e.latlon.split(",")[1]),i.longitude=parseFloat(e.latlon.split(",")[0]),i.location=e.city.value+e.dist.value+e.town.value+e.poi,d.setLatLng(t.latlng),d.unbindTooltip().bindTooltip(e.city.value+e.dist.value+e.town.value+e.poi,{offset:[0,10],direction:"bottom"}).openTooltip()},error:function(t){dd.alert({content:"地址解析出错"})}})}),$(".iptSearch").on("keydown",function(e){if(13==e.keyCode)if(e.target.value){var n=o+e.target.value,a=encodeURI("http://dh.ditu.zj.cn:18006/geocoding/getLatLonByAddress.jsonp?&city="+o+"&keyword="+n+"&width=500&height=430&pn=1&customer=2&encode=UTF-8");$.ajax({url:a,dataType:"jsonp",success:function(n){if("0.0,0.0"==n.strlatlon)dd.alert({content:"未查询到相关信息"});else{i.latitude=parseFloat(n.strlatlon.split(",")[1]),i.longitude=parseFloat(n.strlatlon.split(",")[0]),i.location=n.city+e.target.value;var o={lon:i.longitude,lat:i.latitude};d.setLatLng(o),d.unbindTooltip().bindTooltip(e.target.value,{offset:[0,10],direction:"bottom"}).openTooltip(),t.panTo(o)}},error:function(t){dd.alert({content:"地址解析出错"})}})}else dd.alert({content:"请输入查询关键字"})}),$(".resetBtn").on("click",function(e){t.setView([Number(n.lat),Number(n.lon)],a),d.unbindTooltip().setLatLng(n)}),$(".modifyBtn").on("click",function(){dd.postMessage(i)})}()}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvbGFiZWwuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJkb2N1bWVudCIsIndyaXRlbG4iLCJkZCIsImdldEVudiIsInJlcyIsIm1pbmlwcm9ncmFtIiwiYWxlcnQiLCJjb250ZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsImluaXRMYXRsbmciLCJjaXR5TmFtZSIsImluaXRab29tIiwibmV3Q2VudGVyRGF0YSIsInBvc3RNZXNzYWdlIiwib25NZXNzYWdlIiwiZSIsImxvbiIsImxhdCIsIiQiLCJhamF4IiwidXJsIiwiZW5jb2RlVVJJIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwibGF0aXR1ZGUiLCJwYXJzZUZsb2F0IiwibGF0bG9uIiwic3BsaXQiLCJsb25naXR1ZGUiLCJsb2NhdGlvbiIsImNpdHkiLCJkaXN0IiwidG93biIsInBvaSIsImVycm9yIiwiZXJyIiwibWFwIiwiTCIsImNycyIsIkNSUyIsIkN1c3RvbUVQU0c0MzI2IiwiY2VudGVyIiwibWluWm9vbSIsInpvb20iLCJpbmVydGlhRGVjZWxlcmF0aW9uIiwiem9vbUNvbnRyb2wiLCJsYXllciIsIkdYWVoiLCJ0aWxlU2l6ZSIsImFkZExheWVyIiwibGFiZWxMYXllciIsImhpdERldGVjdGlvbiIsImtlZXBCdWZmZXIiLCJ1cGRhdGVXaGVuWm9vbWluZyIsImN1c3RvbUljb24iLCJpY29uIiwiaWNvblVybCIsImljb25TaXplIiwiaWNvbkFuY2hvciIsIm1hcmtlciIsImdldENlbnRlciIsImxuZyIsImRyYWdnYWJsZSIsIm9wYWNpdHkiLCJhZGRUbyIsImNpcmNsZSIsInJhZGl1cyIsIm9uIiwicmV2ZXJzZVJlc29sdXRpb25VcmwiLCJsYXRsbmciLCJzZXRMYXRMbmciLCJ1bmJpbmRUb29sdGlwIiwiYmluZFRvb2x0aXAiLCJvZmZzZXQiLCJkaXJlY3Rpb24iLCJvcGVuVG9vbHRpcCIsImtleUNvZGUiLCJ0YXJnZXQiLCJrZXlXb3JkIiwicmVzb2x1dGlvblVybCIsInN0cmxhdGxvbiIsIm5ld0NlbnRlckxhdGxvbiIsInBhblRvIiwic2V0VmlldyIsIk51bWJlciIsImluaXQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsYUFBd0RDLE1BQUEsV0FF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QUNBLElBQUFxRyxHQUFxRGpFLElBQUFKLEVBQUFnQixVQUFBWCxJQUFBTCxFQUFBWSxVQUNyRG1DLEVBQUFXLFVBQUFXLEdBQ0F0QixFQUFBWSxnQkFBQUMsWUFBQXpELEVBQUE4RCxPQUFBakcsT0FBa0Y2RixRQUFBLE1BQUFDLFVBQUEsV0FBc0NDLGNBQ3hIdkMsRUFBQThDLE1BQUFELEtBR0EvQyxNQUFBLFNBQUFDLEdBQ0FsQyxHQUFBSSxPQUNBQyxRQUFBLG1CQUtBTCxHQUFBSSxPQUNBQyxRQUFBLGVBTUFZLEVBQUEsYUFBQWlELEdBQUEsaUJBQUFwRCxHQUNBcUIsRUFBQStDLFNBQUFDLE9BQUEzRSxFQUFBUSxLQUFBbUUsT0FBQTNFLEVBQUFPLE1BQUFMLEdBQ0FnRCxFQUFBWSxnQkFBQUQsVUFBQTdELEtBRUFTLEVBQUEsY0FBQWlELEdBQUEsbUJBQ0FsRSxHQUFBWSxZQUFBRCxLQWpHQXlFIiwiZmlsZSI6ImpzL2xhYmVsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIuL1wiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2Rpbmd0YWxrJykgPiAtMSkge1xyXG4gICAgZG9jdW1lbnQud3JpdGVsbignPHNjcmlwdCBzcmM9XCJodHRwczovL2FwcHgvd2ViLXZpZXcubWluLmpzXCInICsgJz4nICsgJzwnICsgJy8nICsgJ3NjcmlwdD4nKTtcclxuICB9XHJcbiAgZGQuZ2V0RW52KGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICBpZiAoIXJlcy5taW5pcHJvZ3JhbSkge1xyXG4gICAgICAgICAgZGQuYWxlcnQoe1xyXG4gICAgICAgICAgICAgIGNvbnRlbnQ6SlNPTi5zdHJpbmdpZnkoJ+i/kOihjOWHuumUmScpXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gIH0pO1xyXG4gIHZhciBpbml0TGF0bG5nLCBpbml0Wm9vbSA9IDE3LCBjaXR5TmFtZSwgbmV3Q2VudGVyRGF0YSA9IHt9O1xyXG4gIFxyXG4gIGRkLnBvc3RNZXNzYWdlKHt9KTtcclxuICBkZC5vbk1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGluaXRMYXRsbmcgPSB7bG9uOiBlLmxvbiwgbGF0OiBlLmxhdH0gfHwge2xvbjogMTIwLjE0OTg5LCBsYXQ6IDMwLjI3NzUxfTsgIC8vIOm7mOiupOe7j+e6rOW6puS4uuiTneWkqeWVhuWKoeS4reW/g1xyXG4gICAgICBjaXR5TmFtZSA9IGUuY2l0eU5hbWUgfHwgXCLmna3lt57luIJcIjtcclxuICAgICAgJC5hamF4KHtcclxuICAgICAgICAgIHVybDogZW5jb2RlVVJJKFwiaHR0cDovL2RoLmRpdHUuemouY246MTgwMDUvaW52ZXJzZS9nZXRJbnZlcnNlR2VvY29kaW5nLmpzb25wPyZkZXRhaWw9MSZ6b29tPTExJmxhdGxvbj1cIiArIGluaXRMYXRsbmcubG9uICsgXCIsXCIgKyBpbml0TGF0bG5nLmxhdCArIFwiJmxhdD0mbG9uPSZjdXN0b21lcj0yXCIpLFxyXG4gICAgICAgICAgZGF0YVR5cGU6IFwianNvbnBcIixcclxuICAgICAgICAgIC8vIGpzb25wOiBcImNhbGxiYWNrXCIsXHJcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICBuZXdDZW50ZXJEYXRhLmxhdGl0dWRlID0gcGFyc2VGbG9hdChyZXMubGF0bG9uLnNwbGl0KCcsJylbMV0pXHJcbiAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sb25naXR1ZGUgPSBwYXJzZUZsb2F0KHJlcy5sYXRsb24uc3BsaXQoJywnKVswXSlcclxuICAgICAgICAgICAgICBuZXdDZW50ZXJEYXRhLmxvY2F0aW9uID0gcmVzLmNpdHkudmFsdWUgKyByZXMuZGlzdC52YWx1ZSArIHJlcy50b3duLnZhbHVlICsgcmVzLnBvaTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgIGRkLmFsZXJ0KHtcclxuICAgICAgICAgICAgICAgICAgY29udGVudDogXCLlnLDlnYDop6PmnpDlh7rplJlcIlxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgaW5pdCgpXHJcbiAgfVxyXG4gIGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICAgIHZhciBtYXAgPSBMLm1hcCgnbWFwJyx7Y3JzOkwuQ1JTLkN1c3RvbUVQU0c0MzI2LGNlbnRlcjogaW5pdExhdGxuZywgbWluWm9vbTogNSwgem9vbTogaW5pdFpvb20sIGluZXJ0aWFEZWNlbGVyYXRpb246MTUwMDAsIHpvb21Db250cm9sOiBmYWxzZX0pO1xyXG4gICAgICB2YXIgdGlsZUFkZHJlc3MgPSAnaHR0cDovL2RpdHUuemp6d2Z3Lmdvdi5jbi9tYXBzZXJ2ZXIvdm1hcC96anZtYXAvZ2V0TUFQP3g9e3h9Jnk9e3l9Jmw9e3p9JnN0eWxlSWQ9dGR0X2JpYW96aHVueWFuZ3NoaV8yMDE3JztcclxuXHJcbiAgICAgIHZhciBsYXllciA9IG5ldyBMLkdYWVoodGlsZUFkZHJlc3MsIHt0aWxlU2l6ZTo1MTIsIG1pblpvb206IDV9KTtcclxuICAgICAgbWFwLmFkZExheWVyKGxheWVyKTtcclxuXHJcbiAgICAgIC8vIOa3u+WKoOazqOiusOWbvuWxglxyXG4gICAgLy8gICB2YXIgbGFiZWxMYXllciA9IG5ldyBMLkdXVlRBbm5vKHt0aWxlU2l6ZTo1MTJ9KTtcclxuICAgIC8vICAgdmFyIGRhdGFTb3VyY2UgPSBuZXcgQ3VzdG9tLlVSTERhdGFTb3VyY2UoKTtcclxuICAgIC8vICAgZGF0YVNvdXJjZS51cmwgPSAnaHR0cDovL2RpdHUuemp6d2Z3Lmdvdi5jbi9tYXBzZXJ2ZXIvbGFiZWwvemp2bWFwL2dldERhdGFzP3g9JHt4fSZ5PSR7eX0mbD0ke3p9JnN0eWxlSWQ9dGR0X2JpYW96aHVueWFuZ3NoaV8yMDE3JztcclxuICAgIC8vICAgbGFiZWxMYXllci5hZGREYXRhU291cmNlKGRhdGFTb3VyY2UpO1xyXG4gICAgLy8gICBtYXAuYWRkTGF5ZXIobGFiZWxMYXllcik7XHJcbiAgICAgIHZhciBsYWJlbExheWVyID0gbmV3IEwuR1hZWignaHR0cDovL2RpdHUuemp6d2Z3Lmdvdi5jbi9tYXBzZXJ2ZXIvbGFiZWwvemp2bWFwL2dldEltZz94PXt4fSZ5PXt5fSZsPXt6fSZzdHlsZUlkPXRkdF9iaWFvemh1bnlhbmdzaGlfMjAxNycse3RpbGVTaXplOjUxMixoaXREZXRlY3Rpb246dHJ1ZSxrZWVwQnVmZmVyOjAsdXBkYXRlV2hlblpvb21pbmc6ZmFsc2V9KTtcclxuICAgICAgbWFwLmFkZExheWVyKGxhYmVsTGF5ZXIpO1xyXG4gICAgICB2YXIgY3VzdG9tSWNvbiA9IEwuaWNvbih7IFxyXG4gICAgICAgICAgaWNvblVybDogJy4uL2ltZy9pbmRvb3JfcHViX3BvaV9wcmVzc2VkLnBuZycsXHJcbiAgICAgICAgICBpY29uU2l6ZTogWzIxLCAzMF0sXHJcbiAgICAgICAgICBpY29uQW5jaG9yOiAgIFsxMCwgMjBdLFxyXG4gICAgICB9KTsgXHJcbiAgICAgIHZhciBtYXJrZXIgPSBMLm1hcmtlciggXHJcbiAgICAgICAgICBbbWFwLmdldENlbnRlcigpLmxhdCwgbWFwLmdldENlbnRlcigpLmxuZ10sIFxyXG4gICAgICAgICAgeyBcclxuICAgICAgICAgICAgICBkcmFnZ2FibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgICAgaWNvbjogY3VzdG9tSWNvblxyXG4gICAgICAgICAgfVxyXG4gICAgICApLmFkZFRvKG1hcCk7XHJcbiAgICAgIEwuY2lyY2xlKFttYXAuZ2V0Q2VudGVyKCkubGF0LCBtYXAuZ2V0Q2VudGVyKCkubG5nXSwge3JhZGl1czogMzB9KS5hZGRUbyhtYXApO1xyXG5cclxuICAgICAgbWFwLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIHZhciByZXZlcnNlUmVzb2x1dGlvblVybCA9IGVuY29kZVVSSShcImh0dHA6Ly9kaC5kaXR1LnpqLmNuOjE4MDA1L2ludmVyc2UvZ2V0SW52ZXJzZUdlb2NvZGluZy5qc29ucD8mZGV0YWlsPTEmem9vbT0xMSZsYXRsb249XCIgKyBlLmxhdGxuZy5sbmcgKyBcIixcIiArIGUubGF0bG5nLmxhdCArIFwiJmxhdD0mbG9uPSZjdXN0b21lcj0yXCIpO1xyXG4gICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICB1cmw6IHJldmVyc2VSZXNvbHV0aW9uVXJsLFxyXG4gICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25wXCIsXHJcbiAgICAgICAgICAgICAgLy8ganNvbnA6IFwiY2FsbGJhY2tcIixcclxuICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sYXRpdHVkZSA9IHBhcnNlRmxvYXQocmVzLmxhdGxvbi5zcGxpdCgnLCcpWzFdKVxyXG4gICAgICAgICAgICAgICAgICBuZXdDZW50ZXJEYXRhLmxvbmdpdHVkZSA9IHBhcnNlRmxvYXQocmVzLmxhdGxvbi5zcGxpdCgnLCcpWzBdKVxyXG4gICAgICAgICAgICAgICAgICBuZXdDZW50ZXJEYXRhLmxvY2F0aW9uID0gcmVzLmNpdHkudmFsdWUgKyByZXMuZGlzdC52YWx1ZSArIHJlcy50b3duLnZhbHVlICsgcmVzLnBvaTtcclxuICAgICAgICAgICAgICAgICAgbWFya2VyLnNldExhdExuZyhlLmxhdGxuZyk7XHJcbiAgICAgICAgICAgICAgICAgIG1hcmtlci51bmJpbmRUb29sdGlwKCkuYmluZFRvb2x0aXAocmVzLmNpdHkudmFsdWUgKyByZXMuZGlzdC52YWx1ZSArIHJlcy50b3duLnZhbHVlICsgcmVzLnBvaSwge29mZnNldDogWzAsIDEwXSwgZGlyZWN0aW9uIDogXCJib3R0b21cIn0pLm9wZW5Ub29sdGlwKCk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICBkZC5hbGVydCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBcIuWcsOWdgOino+aekOWHuumUmVwiXHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgICQoJy5pcHRTZWFyY2gnKS5vbigna2V5ZG93bicsZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAvLyBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICBpZihlLmtleUNvZGUgPT0gMTMpe1xyXG4gICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBrZXlXb3JkID0gY2l0eU5hbWUgKyBlLnRhcmdldC52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgdmFyIHJlc29sdXRpb25VcmwgPSBlbmNvZGVVUkkoXCJodHRwOi8vZGguZGl0dS56ai5jbjoxODAwNi9nZW9jb2RpbmcvZ2V0TGF0TG9uQnlBZGRyZXNzLmpzb25wPyZjaXR5PVwiICsgY2l0eU5hbWUgKyBcIiZrZXl3b3JkPVwiICsga2V5V29yZCArIFwiJndpZHRoPTUwMCZoZWlnaHQ9NDMwJnBuPTEmY3VzdG9tZXI9MiZlbmNvZGU9VVRGLThcIik7XHJcbiAgICAgICAgICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IHJlc29sdXRpb25VcmwsXHJcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29ucFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgLy8ganNvbnA6IFwiY2FsbGJhY2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3RybGF0bG9uID09IFwiMC4wLDAuMFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRkLmFsZXJ0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwi5pyq5p+l6K+i5Yiw55u45YWz5L+h5oGvXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sYXRpdHVkZSA9IHBhcnNlRmxvYXQocmVzLnN0cmxhdGxvbi5zcGxpdCgnLCcpWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2VudGVyRGF0YS5sb25naXR1ZGUgPSBwYXJzZUZsb2F0KHJlcy5zdHJsYXRsb24uc3BsaXQoJywnKVswXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NlbnRlckRhdGEubG9jYXRpb24gPSByZXMuY2l0eSArIGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2VudGVyTGF0bG9uID0ge2xvbjogbmV3Q2VudGVyRGF0YS5sb25naXR1ZGUsIGxhdDogbmV3Q2VudGVyRGF0YS5sYXRpdHVkZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLnNldExhdExuZyhuZXdDZW50ZXJMYXRsb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIudW5iaW5kVG9vbHRpcCgpLmJpbmRUb29sdGlwKGUudGFyZ2V0LnZhbHVlLCB7b2Zmc2V0OiBbMCwgMTBdLCBkaXJlY3Rpb24gOiBcImJvdHRvbVwifSkub3BlblRvb2x0aXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLnBhblRvKG5ld0NlbnRlckxhdGxvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZC5hbGVydCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwi5Zyw5Z2A6Kej5p6Q5Ye66ZSZXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgZGQuYWxlcnQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgY29udGVudDogXCLor7fovpPlhaXmn6Xor6LlhbPplK7lrZdcIlxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICAkKCcucmVzZXRCdG4nKS5vbignY2xpY2snLGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgbWFwLnNldFZpZXcoW051bWJlcihpbml0TGF0bG5nLmxhdCksIE51bWJlcihpbml0TGF0bG5nLmxvbildLCBpbml0Wm9vbSk7XHJcbiAgICAgICAgICBtYXJrZXIudW5iaW5kVG9vbHRpcCgpLnNldExhdExuZyhpbml0TGF0bG5nKTtcclxuICAgICAgfSk7XHJcbiAgICAgICQoXCIubW9kaWZ5QnRuXCIpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIGRkLnBvc3RNZXNzYWdlKG5ld0NlbnRlckRhdGEpO1xyXG4gICAgICB9KVxyXG5cclxuICB9Il0sInNvdXJjZVJvb3QiOiIifQ==